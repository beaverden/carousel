"use strict";var Lightsel=window.Lightsel||{};Lightsel=function(){function a(a){this.settings={infiniteSpin:!1,realFirst:null,realFirstID:0,copyFirst:null,realLast:null,realLastID:0,copyLast:null,autoscroll:!1,autoscroll_interval:3e3,fillWithCopies:!1,filledWithCopies:!1,spinOnLessObjects:!1,id:"lightsel1",arrowHoldInterval:100,events:!0,lightsel:null,movingWrapper:null,moving:null,objects:null,toFirst:null,toLast:null,inertionStartSpeed:20,dragStarted:!1,totalObjects:0,previousActiveObject:-1,currentActiveObject:0,currentRelativePosition:0,hasTransform:!0};for(var b in a)this.settings[b]=a[b];var c=this;c.Init()}return a}(),Lightsel.prototype.Init=function(){var a=this;a.settings.lightsel=document.getElementById(a.settings.id),a.settings.movingWrapper=a.settings.lightsel.querySelector(".moving-wrapper"),a.settings.moving=a.settings.lightsel.querySelector(".moving"),a.settings.objects=a.settings.lightsel.querySelectorAll(".object"),a.settings.totalObjects=a.settings.movingWrapper.children.length,a.settings.toFirst=a.settings.lightsel.querySelector(".lightsel-left"),a.settings.toLast=a.settings.lightsel.querySelector(".lightsel-right");var b=a.settings.lightsel;"undefined"===b&&console.log("Wrong lightsel id"),0==a.settings.events&&console.log("Lightrousel: Events turned off"),a.settings.fillWithCopies&&a.FillWithCopies(),a.settings.hasTransform=a.DetectCSSFeature("transform"),a.settings.totalObjects=a.settings.objects.length,a.settings.infiniteSpin&&(a.settings.filledWithCopies||a.FillWithCopies(),a.InfiniteSpin()),a.settings.autoscroll&&setInterval(function(){a.SetActiveAndShow(a.GetNextObjectId())},a.settings.autoscroll_interval),a.ClickEvents(),a.DragEvents(),a.ClickEventsArrows(),a.HoldArrowsEvents()},Lightsel.prototype.GenEventAndDispatch=function(a,b){var c=this;if(c.settings.events&&"function"==typeof CustomEvent){var d=new CustomEvent(a,{detail:b,bubbles:!0,cancelable:!0});c.settings.lightsel.dispatchEvent(d)}},Lightsel.prototype.ClickEvents=function(){for(var a=this,b=function(b){var c=this;a.GenEventAndDispatch("lightsel_objectClicked",{lightselID:a.settings.id,objectId:c.getAttribute("data-id")});var d=parseInt(c.getAttribute("data-id"));a.SetActiveAndShow(d)},c=0;c<a.settings.objects.length;c++){var d=a.settings.objects[c];d.setAttribute("data-id",c),d.addEventListener?d.addEventListener("click",b):d.attachEvent("onclick",b)}},Lightsel.prototype.DragEvents=function(){var a=this,b=a.settings.lightsel,c=a.settings.moving,e=(a.settings.movingWrapper,0);c.onclick=function(a){return!1},c.onmousedown=function(c){c||(c=window.event);var d=c.clientX;document.onmousemove=function(c){c||(c=window.event),c.preventDefault?c.preventDefault():c.returnValue=!1;var f=c.clientX,g=f-d;d=f,e=g,Math.abs(e)>0&&(a.GenEventAndDispatch("lightsel_dragged",{lightselID:a.settings.lightsel.id,dragAmout:g}),a.settings.dragStarted||(a.settings.dragStarted=!0,a.GenEventAndDispatch("lightsel_dragStart",{lightselID:b.id}))),a.TranslateMoving(g)},document.onmouseup=function(b){b||(b=window.event),document.onmousemove=null,document.onmouseup=null,a.settings.dragStarted&&(a.GenEventAndDispatch("lightsel_dragEnd",{lightselID:a.settings.lightsel.id}),a.settings.dragStarted=!1),Math.abs(e)>3&&a.SpinInertion(e),e=0,b.preventDefault?b.preventDefault():b.returnValue=!1,b.stopPropagation?b.stopPropagation():b.cancelBubble=!0}}},Lightsel.prototype.ClickEventsArrows=function(){var a=this,b=a.settings.toFirst,c=a.settings.toLast;b&&b.addEventListener||c&&c.addEventListener?(b&&b.addEventListener("click",function(){a.SetActiveAndShow(a.GetPreviousObjectId(),!1)}),c&&c.addEventListener("click",function(){a.SetActiveAndShow(a.GetNextObjectId(),!1)})):(b&&b.attachEvent("onclick",function(){a.SetActiveAndShow(a.GetPreviousObjectId(),!1)}),c&&c.attachEvent("onclick",function(){a.SetActiveAndShow(a.GetNextObjectId(),!1)}))},Lightsel.prototype.HoldArrowsEvents=function(){var a=this,b=a.settings.toFirst,c=a.settings.toLast;b&&(b.onmousedown=function(){var c=setInterval(function(){a.SetActiveAndShow(a.GetPreviousObjectId(),!1)},a.settings.arrowHoldInterval);b.onmouseup=function(){clearInterval(c)},b.onmouseout=function(){clearInterval(c)}}),c&&(c.onmousedown=function(){var b=setInterval(function(){a.SetActiveAndShow(a.GetNextObjectId(),!1)},a.settings.arrowHoldInterval);c.onmouseup=function(){clearInterval(b)},c.onmouseout=function(){clearInterval(b)}})},Lightsel.prototype.ShowObject=function(a,b){var k,l,m,n,c=this,f=(c.settings.lightsel,c.settings.objects,c.settings.lightsel.querySelector(".moving-wrapper")),g=c.settings.lightsel.querySelector(".moving"),h=c.settings.objects[a],i=f.getBoundingClientRect(),j=h.getBoundingClientRect();i=f.getBoundingClientRect(),j=h.getBoundingClientRect(),k=j.left,l=j.right,m=i.left,n=i.right;var o=c.settings.currentRelativePosition;k<m&&(o=c.settings.currentRelativePosition+m-k),l>n&&(o=c.settings.currentRelativePosition-(l-n)),b&&(o=m-k),c.settings.hasTransform?c.ApplyCSS(g,"transform","translate3d("+o+"px, 0px, 0px)"):c.ApplyCSS(g,"left",o+"px"),c.settings.currentRelativePosition!=o&&c.GenEventAndDispatch("lightsel_moved",{lightselID:c.settings.id,moveAmount:Math.abs(c.settings.currentRelativePosition-o)}),c.settings.currentRelativePosition=o},Lightsel.prototype.SetActive=function(a){var b=this;a=parseInt(a);var c=b.settings.objects[b.settings.currentActiveObject];c.className=c.className.replace(" active","");var d=b.settings.objects[a];d.className=d.className.replace(" active",""),d.className+=" active",b.settings.currentActiveObject=a},Lightsel.prototype.SetActiveAndShow=function(a,b){var c=this;c.SetActive(a),c.ShowObject(a,b)},Lightsel.prototype.GetPreviousObjectId=function(){var a=this,b=a.settings.currentActiveObject;return b>0?b-1:a.settings.totalObjects-1},Lightsel.prototype.GetNextObjectId=function(){var a=this,b=a.settings.currentActiveObject;return b<a.settings.totalObjects-1?b+1:0},Lightsel.prototype.InfiniteSpin=function(){for(var a=this,b=a.settings.moving,c=a.settings.objects,d=[],e=0;e<c.length;e++){var f=c[e].cloneNode(!0);f.className=f.className.replace(" active",""),d.push(f)}a.settings.copyFirst=d[0];for(var g=null,e=0;e<c.length;e++){var f=c[e].cloneNode(!0);f.className=f.className.replace(" active",""),d.push(f),0==e&&(g=d.length-1,a.settings.realFirst=f,a.settings.realFirstID=g)}a.settings.realLast=d[d.length-1],a.settings.realLastID=d.length-1;for(var e=0;e<c.length;e++){var f=c[e].cloneNode(!0);f.className=f.className.replace(" active",""),d.push(f)}for(a.settings.copyLast=d[d.length-1];b.firstChild;)b.removeChild(b.firstChild);for(var e=0;e<d.length;e++)a.settings.moving.appendChild(d[e]);a.settings.objects=d,a.settings.totalObjects=d.length,a.settings.currentActiveObject=a.settings.realFirstID,a.ClickEvents(),a.SetActiveAndShow(a.settings.realFirstID,!0)},Lightsel.prototype.CopyElementsReached=function(){var a=this,b=a.settings.copyFirst,c=a.settings.copyLast,f=(a.settings.realFisrt,a.settings.realLast,b.getBoundingClientRect());f=b.getBoundingClientRect();var g=c.getBoundingClientRect();g=c.getBoundingClientRect();var h=a.settings.movingWrapper.getBoundingClientRect();h=a.settings.movingWrapper.getBoundingClientRect();var i=f.left,j=g.right,k=h.left,l=h.right;return i>k?(a.ShowObject(a.settings.realLastID,!1),!0):j<l&&(a.ShowObject(a.settings.realFirstID,!1),!0)},Lightsel.prototype.TranslateMoving=function(a){var b=this,c=b.settings.moving,e=(b.settings.movingWrapper,b.settings.lightsel);return!(!b.settings.infiniteSpin||!b.CopyElementsReached())||void(b.CheckInterval(a)&&(b.GenEventAndDispatch("lightsel_moved",{lightselID:e.id,moveAmount:a}),b.settings.currentRelativePosition+=a,b.settings.hasTransform?b.ApplyCSS(c,"transform","translate3d("+b.settings.currentRelativePosition+"px, 0px, 0px)"):b.ApplyCSS(c,"left",b.settings.currentRelativePosition+"px")))},Lightsel.prototype.SpinInertion=function(a){var b=this,c=a<0?-b.settings.inertionStartSpeed:b.settings.inertionStartSpeed,d=setInterval(function(){b.TranslateMoving(c),0==c?clearInterval(d):c+=c>0?-1:1},20)},Lightsel.prototype.CheckInterval=function(a){var b=this,c=b.settings.movingWrapper,d=b.settings.moving,e=d.querySelector(".object").offsetWidth,f=d.getBoundingClientRect().left,g=d.getBoundingClientRect().right,h=c.getBoundingClientRect().left,i=c.getBoundingClientRect().right;f=d.getBoundingClientRect().left,g=d.getBoundingClientRect().right,h=c.getBoundingClientRect().left,i=c.getBoundingClientRect().right;var j=a>0,k=!j,l=k&&g+a>h&&g-e>h;return l|=j&&f+a<i&&f+e<i,0==b.settings.spinOnLessObjects&&f>h&&g<i&&(l=!1),l},Lightsel.prototype.FillWithCopies=function(){var a=this,b=[],c=a.settings.movingWrapper.getBoundingClientRect();c=a.settings.movingWrapper.getBoundingClientRect(),a.settings.filledWithCopies=!0;for(var d=0;d<a.settings.objects.length;d++){var e=a.settings.objects[d];b.push(e)}for(var f=0;;){var g=b[b.length-1],h=g.getBoundingClientRect();h=g.getBoundingClientRect();var i=h.right,j=c.right;if(!(i<j))break;var k=a.GetCopy(a.settings.objects[f]);k.className=k.className.replace(" active",""),b.push(k),a.settings.moving.appendChild(k),f++,f==a.settings.objects.length&&(f=0)}for(;f<a.settings.objects.length;){var k=a.GetCopy(a.settings.objects[f]);k.className=k.className.replace(" active",""),b.push(k),a.settings.moving.appendChild(k),f++}a.settings.objects=b},Lightsel.prototype.ApplyCSS=function(a,b,c){"transform"==b?(a.style.WebkitTransform=c,a.style.MozTransform=c,a.style.msTransform=c,a.style.OTransform=c,a.style.transform=c):"left"===b&&(a.style.WebkitLeft=c,a.style.MozLeft=c,a.style.msLeft=c,a.style.OLeft=c,a.style.left=c)},Lightsel.prototype.DetectCSSFeature=function(a){var b=!1,c="Webkit Moz ms O".split(" "),d=document.createElement("div"),e=null;if(a=a.toLowerCase(),void 0!==d.style[a]&&(b=!0),b===!1){e=a.charAt(0).toUpperCase()+a.substr(1);for(var f=0;f<c.length;f++)if(void 0!==d.style[c[f]+e]){b=!0;break}}return b},Lightsel.prototype.GetCopy=function(a){var b=a.cloneNode(!0);return b.className=b.className.replace(" active",""),b},Lightsel.prototype.next=function(a,b){this.SetActiveAndShow(this.GetNextObjectId(),b),"undefined"!=typeof a&&a()},Lightsel.prototype.previous=function(a,b){this.SetActiveAndShow(this.GetPreviousObjectId(),b),"undefined"!=typeof a&&a()},Lightsel.prototype.setObjectActive=function(a,b){this.SetActive(b),"undefined"!=typeof a&&a()},Lightsel.prototype.getCurrentActiveObject=function(a){"undefined"!=typeof a&&a(this.settings.currentActiveObject)},Lightsel.prototype.showObject=function(a,b,c){showObject(objId,c),"undefined"!=typeof a&&a()},Lightsel.prototype.getObjects=function(a){"undefined"!=typeof a&&a(this.settings.objects)};