"use strict";var Lightsel=window.Lightsel||{};Lightsel=function(){function t(t){this.settings={infiniteSpin:!1,realFirst:null,realFirstID:0,copyFirst:null,realLast:null,realLastID:0,copyLast:null,autoscroll:!1,autoscroll_interval:3e3,fillWithCopies:!1,filledWithCopies:!1,spinOnLessObjects:!1,id:"lightsel1",arrowHoldInterval:100,events:!0,lightsel:null,movingWrapper:null,moving:null,objects:null,toFirst:null,toLast:null,inertionStartSpeed:20,dragStarted:!1,totalObjects:0,previousActiveObject:-1,currentActiveObject:0,currentRelativePosition:0,hasTransform:!0,arrows:!1};for(var e in t)this.settings[e]=t[e];var n=this;n.Init()}return t}(),Lightsel.prototype.Init=function(){var t=this;t.settings.lightsel=document.getElementById(t.settings.id);var e=t.settings.lightsel.children,n=document.createElement("div");n.className="control-wrapper";var s=document.createElement("div");s.className="moving-wrapper";var i=document.createElement("div");for(i.className="moving",i.style.transform="translate3d(0px, 0px, 0px)",i.style.left="0px";e.length>0;)i.appendChild(e[0]);if(s.appendChild(i),t.settings.arrows&&(t.settings.lightsel.classList+=" arrows"),t.settings.arrows){var o=document.createElement("button");o.classList="arrow lightsel-left";var r=document.createElement("div");r.classList="arrow-inner",r.innerHTML="&lsaquo;",o.appendChild(r),n.appendChild(o)}if(n.appendChild(s),t.settings.arrows){var l=document.createElement("button");l.classList="arrow lightsel-right";var a=document.createElement("div");a.classList="arrow-inner",a.innerHTML="&rsaquo;",l.appendChild(a),n.appendChild(l)}t.settings.lightsel.appendChild(n),t.settings.movingWrapper=t.settings.lightsel.querySelector(".moving-wrapper"),t.settings.moving=t.settings.lightsel.querySelector(".moving"),t.settings.objects=t.settings.lightsel.querySelectorAll(".object"),t.settings.totalObjects=t.settings.movingWrapper.children.length,t.settings.toFirst=t.settings.lightsel.querySelector(".lightsel-left"),t.settings.toLast=t.settings.lightsel.querySelector(".lightsel-right");var c=t.settings.lightsel;"undefined"===c&&console.log("Wrong lightsel id"),0==t.settings.events&&console.log("Lightrousel: Events turned off"),t.settings.objects[0].classList+=" active",t.settings.fillWithCopies&&t.FillWithCopies(),t.settings.hasTransform=t.DetectCSSFeature("transform"),t.settings.totalObjects=t.settings.objects.length,t.settings.infiniteSpin&&(t.settings.filledWithCopies||t.FillWithCopies(),t.InfiniteSpin()),t.settings.autoscroll&&setInterval(function(){t.SetActiveAndShow(t.GetNextObjectId())},t.settings.autoscroll_interval),t.ClickEvents(),t.DragEvents(),t.ClickEventsArrows(),t.HoldArrowsEvents()},Lightsel.prototype.GenEventAndDispatch=function(t,e){var n=this;if(n.settings.events&&"function"==typeof CustomEvent){var s=new CustomEvent(t,{detail:e,bubbles:!0,cancelable:!0});n.settings.lightsel.dispatchEvent(s)}},Lightsel.prototype.ClickEvents=function(){for(var t=this,e=function(e){var n=this;t.GenEventAndDispatch("lightsel_objectClicked",{lightselID:t.settings.id,objectId:n.getAttribute("data-id")});var s=parseInt(n.getAttribute("data-id"));t.SetActiveAndShow(s)},n=0;n<t.settings.objects.length;n++){var s=t.settings.objects[n];s.setAttribute("data-id",n),s.addEventListener?s.addEventListener("click",e):s.attachEvent("onclick",e)}},Lightsel.prototype.DragEvents=function(){var t=this,e=t.settings.lightsel,n=t.settings.moving,s=(t.settings.movingWrapper,0);n.onclick=function(t){return!1},n.onmousedown=function(n){n||(n=window.event);var i=n.clientX;document.onmousemove=function(n){n||(n=window.event),n.preventDefault?n.preventDefault():n.returnValue=!1;var o=n.clientX,r=o-i;i=o,s=r,Math.abs(s)>0&&(t.GenEventAndDispatch("lightsel_dragged",{lightselID:t.settings.lightsel.id,dragAmout:r}),t.settings.dragStarted||(t.settings.dragStarted=!0,t.GenEventAndDispatch("lightsel_dragStart",{lightselID:e.id}))),t.TranslateMoving(r)},document.onmouseup=function(e){e||(e=window.event),document.onmousemove=null,document.onmouseup=null,t.settings.dragStarted&&(t.GenEventAndDispatch("lightsel_dragEnd",{lightselID:t.settings.lightsel.id}),t.settings.dragStarted=!1),Math.abs(s)>3&&t.SpinInertion(s),s=0,e.preventDefault?e.preventDefault():e.returnValue=!1,e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}}},Lightsel.prototype.ClickEventsArrows=function(){var t=this,e=t.settings.toFirst,n=t.settings.toLast;e&&e.addEventListener||n&&n.addEventListener?(e&&e.addEventListener("click",function(){t.SetActiveAndShow(t.GetPreviousObjectId(),!1)}),n&&n.addEventListener("click",function(){t.SetActiveAndShow(t.GetNextObjectId(),!1)})):(e&&e.attachEvent("onclick",function(){t.SetActiveAndShow(t.GetPreviousObjectId(),!1)}),n&&n.attachEvent("onclick",function(){t.SetActiveAndShow(t.GetNextObjectId(),!1)}))},Lightsel.prototype.HoldArrowsEvents=function(){var t=this,e=t.settings.toFirst,n=t.settings.toLast;e&&(e.onmousedown=function(){var n=setInterval(function(){t.SetActiveAndShow(t.GetPreviousObjectId(),!1)},t.settings.arrowHoldInterval);e.onmouseup=function(){clearInterval(n)},e.onmouseout=function(){clearInterval(n)}}),n&&(n.onmousedown=function(){var e=setInterval(function(){t.SetActiveAndShow(t.GetNextObjectId(),!1)},t.settings.arrowHoldInterval);n.onmouseup=function(){clearInterval(e)},n.onmouseout=function(){clearInterval(e)}})},Lightsel.prototype.ShowObject=function(t,e){var n,s,i,o,r=this,l=(r.settings.lightsel,r.settings.objects,r.settings.lightsel.querySelector(".moving-wrapper")),a=r.settings.lightsel.querySelector(".moving"),c=r.settings.objects[t],g=l.getBoundingClientRect(),v=c.getBoundingClientRect();g=l.getBoundingClientRect(),v=c.getBoundingClientRect(),n=v.left,s=v.right,i=g.left,o=g.right;var p=r.settings.currentRelativePosition;i>n&&(p=r.settings.currentRelativePosition+i-n),s>o&&(p=r.settings.currentRelativePosition-(s-o)),e&&(p=i-n),r.settings.hasTransform?r.ApplyCSS(a,"transform","translate3d("+p+"px, 0px, 0px)"):r.ApplyCSS(a,"left",p+"px"),r.settings.currentRelativePosition!=p&&r.GenEventAndDispatch("lightsel_moved",{lightselID:r.settings.id,moveAmount:Math.abs(r.settings.currentRelativePosition-p)}),r.settings.currentRelativePosition=p},Lightsel.prototype.SetActive=function(t){var e=this;t=parseInt(t);var n=e.settings.objects[e.settings.currentActiveObject];n.className=n.className.replace(" active","");var s=e.settings.objects[t];s.className=s.className.replace(" active",""),s.className+=" active",e.settings.currentActiveObject=t},Lightsel.prototype.SetActiveAndShow=function(t,e){var n=this;n.SetActive(t),n.ShowObject(t,e)},Lightsel.prototype.GetPreviousObjectId=function(){var t=this,e=t.settings.currentActiveObject;return e>0?e-1:t.settings.totalObjects-1},Lightsel.prototype.GetNextObjectId=function(){var t=this,e=t.settings.currentActiveObject;return e<t.settings.totalObjects-1?e+1:0},Lightsel.prototype.InfiniteSpin=function(){for(var t=this,e=t.settings.moving,n=t.settings.objects,s=[],i=0;i<n.length;i++){var o=n[i].cloneNode(!0);o.className=o.className.replace(" active",""),s.push(o)}t.settings.copyFirst=s[0];for(var r=null,i=0;i<n.length;i++){var o=n[i].cloneNode(!0);o.className=o.className.replace(" active",""),s.push(o),0==i&&(r=s.length-1,t.settings.realFirst=o,t.settings.realFirstID=r)}t.settings.realLast=s[s.length-1],t.settings.realLastID=s.length-1;for(var i=0;i<n.length;i++){var o=n[i].cloneNode(!0);o.className=o.className.replace(" active",""),s.push(o)}for(t.settings.copyLast=s[s.length-1];e.firstChild;)e.removeChild(e.firstChild);for(var i=0;i<s.length;i++)t.settings.moving.appendChild(s[i]);t.settings.objects=s,t.settings.totalObjects=s.length,t.settings.currentActiveObject=t.settings.realFirstID,t.ClickEvents(),t.SetActiveAndShow(t.settings.realFirstID,!0)},Lightsel.prototype.CopyElementsReached=function(){var t=this,e=t.settings.copyFirst,n=t.settings.copyLast,s=(t.settings.realFisrt,t.settings.realLast,e.getBoundingClientRect());s=e.getBoundingClientRect();var i=n.getBoundingClientRect();i=n.getBoundingClientRect();var o=t.settings.movingWrapper.getBoundingClientRect();o=t.settings.movingWrapper.getBoundingClientRect();var r=s.left,l=i.right,a=o.left,c=o.right;return r>a?(t.ShowObject(t.settings.realLastID,!1),!0):c>l?(t.ShowObject(t.settings.realFirstID,!1),!0):!1},Lightsel.prototype.TranslateMoving=function(t){var e=this,n=e.settings.moving,s=(e.settings.movingWrapper,e.settings.lightsel);return e.settings.infiniteSpin&&e.CopyElementsReached()?!0:void(e.CheckInterval(t)&&(e.GenEventAndDispatch("lightsel_moved",{lightselID:s.id,moveAmount:t}),e.settings.currentRelativePosition+=t,e.settings.hasTransform?e.ApplyCSS(n,"transform","translate3d("+e.settings.currentRelativePosition+"px, 0px, 0px)"):e.ApplyCSS(n,"left",e.settings.currentRelativePosition+"px")))},Lightsel.prototype.SpinInertion=function(t){var e=this,n=0>t?-e.settings.inertionStartSpeed:e.settings.inertionStartSpeed,s=setInterval(function(){e.TranslateMoving(n),0==n?clearInterval(s):n+=n>0?-1:1},20)},Lightsel.prototype.CheckInterval=function(t){var e=this,n=e.settings.movingWrapper,s=e.settings.moving,i=s.querySelector(".object").offsetWidth,o=s.getBoundingClientRect().left,r=s.getBoundingClientRect().right,l=n.getBoundingClientRect().left,a=n.getBoundingClientRect().right;o=s.getBoundingClientRect().left,r=s.getBoundingClientRect().right,l=n.getBoundingClientRect().left,a=n.getBoundingClientRect().right;var c=t>0,g=!c,v=g&&r+t>l&&r-i>l;return v|=c&&a>o+t&&a>o+i,0==e.settings.spinOnLessObjects&&o>l&&a>r&&(v=!1),v},Lightsel.prototype.FillWithCopies=function(){var t=this,e=[],n=t.settings.movingWrapper.getBoundingClientRect();n=t.settings.movingWrapper.getBoundingClientRect(),t.settings.filledWithCopies=!0;for(var s=0;s<t.settings.objects.length;s++){var i=t.settings.objects[s];e.push(i)}for(var o=0;;){var r=e[e.length-1],l=r.getBoundingClientRect();l=r.getBoundingClientRect();var a=l.right,c=n.right;if(!(c>a))break;var g=t.GetCopy(t.settings.objects[o]);g.className=g.className.replace(" active",""),e.push(g),t.settings.moving.appendChild(g),o++,o==t.settings.objects.length&&(o=0)}for(;o<t.settings.objects.length;){var g=t.GetCopy(t.settings.objects[o]);g.className=g.className.replace(" active",""),e.push(g),t.settings.moving.appendChild(g),o++}t.settings.objects=e},Lightsel.prototype.ApplyCSS=function(t,e,n){"transform"==e?(t.style.WebkitTransform=n,t.style.MozTransform=n,t.style.msTransform=n,t.style.OTransform=n,t.style.transform=n):"left"===e&&(t.style.WebkitLeft=n,t.style.MozLeft=n,t.style.msLeft=n,t.style.OLeft=n,t.style.left=n)},Lightsel.prototype.DetectCSSFeature=function(t){var e=!1,n="Webkit Moz ms O".split(" "),s=document.createElement("div"),i=null;if(t=t.toLowerCase(),void 0!==s.style[t]&&(e=!0),e===!1){i=t.charAt(0).toUpperCase()+t.substr(1);for(var o=0;o<n.length;o++)if(void 0!==s.style[n[o]+i]){e=!0;break}}return e},Lightsel.prototype.GetCopy=function(t){var e=t.cloneNode(!0);return e.className=e.className.replace(" active",""),e},Lightsel.prototype.next=function(t,e){this.SetActiveAndShow(this.GetNextObjectId(),e),"undefined"!=typeof t&&t()},Lightsel.prototype.previous=function(t,e){this.SetActiveAndShow(this.GetPreviousObjectId(),e),"undefined"!=typeof t&&t()},Lightsel.prototype.setObjectActive=function(t,e){this.SetActive(e),"undefined"!=typeof t&&t()},Lightsel.prototype.getCurrentActiveObject=function(t){"undefined"!=typeof t&&t(this.settings.currentActiveObject)},Lightsel.prototype.showObject=function(t,e,n){showObject(objId,n),"undefined"!=typeof t&&t()},Lightsel.prototype.getObjects=function(t){"undefined"!=typeof t&&t(this.settings.objects)};